(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{270:function(e,t,r){},514:function(e,t,r){},515:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(51),s=r.n(c),o=r(14),i=(r(270),r(31)),l=r(3),d=r(15),u="POST",j="PUT",b="DELETE";function m(e,t){var r=t.type,a=t.preprocessed,n=t.status,c=t.payload;if("RESET"===r)return c;if(!1===a){console.log("entering switch"),console.log("not preprocessed");var s=c;return console.log(s),Object(l.a)(Object(l.a)({},e),{},{hasError:!0,preprocessingState:Object(l.a)(Object(l.a)({},e.preprocessingState),{},{isSuccess:!1,failureDetails:Object(l.a)(Object(l.a)({},e.failureDetails),{},{failureMessage:"Please check the errors",fieldErrors:s})})})}if(a){if(200===n)return Object(l.a)(Object(l.a)({},e),{},{hasError:!1,preprocessingState:Object(l.a)(Object(l.a)({},e.preprocessingState),{},{isSuccess:!0}),postprocessingState:Object(l.a)(Object(l.a)({},e.postprocessingState),{},{isSuccess:!0,successDetails:Object(l.a)(Object(l.a)({},e.successDetails),{},{successMessage:c.message,resourceId:c.resourceId})})});return Object(l.a)(Object(l.a)({},e),{},{hasError:!0,preprocessingState:Object(l.a)(Object(l.a)({},e.preprocessingState),{},{failureDetails:Object(l.a)(Object(l.a)({},e.preprocessingState.failureDetails),{},{fieldErrors:{nameError:"",profileNameError:"",emailError:"",passwordError:"",DOBError:"",userSummaryError:""}}),isSuccess:!0}),postprocessingState:Object(l.a)(Object(l.a)({},e.postprocessingState),{},{isSuccess:!1,failureDetails:Object(l.a)(Object(l.a)({},e.failureDetails),{},{failureMessage:c.message,details:c.details})})})}}var p={hasError:!1,preprocessingState:{isSuccess:!1,failureDetails:{fieldErrors:{idError:"",nameError:"",profileNameError:"",emailError:"",passwordError:"",DOBError:"",userSummaryError:""}}},postprocessingState:{isSuccess:!1,successDetails:{successMessage:"",resourceId:-1},failureDetails:{failureMessage:"",detials:[]}}},O=function(e,t,r){var a=!0;if(""===e.name&&(t.nameError="Field can't be empty",a=!1),""===e.profileName&&(t.profileNameError="Field can't be empty",a=!1),r===u)if(""===e.email)t.emailError="Field can't be empty",a=!1;else{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.email).toLowerCase())||(t.emailError="Incorrect email format",a=!1)}if(r===u)if(""===e.password)t.passwordError="Field can't be empty",a=!1;else{/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/.test(String(e.password))||(t.passwordError="Incorrect password format",a=!1)}return""===e.dob&&(t.DOBError="Field can't be empty",a=!1),a},h=r(256),f=Object(h.a)(),x=r(524),g=r(258),y=r(259),v=r(1),w=Object(d.h)((function(){var e=Object(a.useState)({id:null,name:"",email:"",profileName:"",password:"",dob:"",userSummary:"",grantedAuthoritiesList:[{authority:"ROLE_USER"}]}),t=Object(o.a)(e,2),r=t[0],n=t[1],c=function(e){var t=e.target.name,a=e.target.value,c=Object(l.a)(Object(l.a)({},r),{},Object(i.a)({},t,a));n(c)},s=Object(a.useReducer)(m,p),d=Object(o.a)(s,2),j=d[0],b=d[1],h={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(l.a)({},r))};return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{style:{height:"60rem"},children:Object(v.jsx)("div",{className:"row h-100",children:Object(v.jsxs)("div",{className:"col-md-4 mx-auto my-auto rounded shadow bg-white",children:[Object(v.jsx)("div",{className:"col-md-4 mx-auto mt-3",children:Object(v.jsx)("h3",{children:"Citizen Sane"})}),Object(v.jsxs)(x.a,{noValidate:!0,onSubmit:function(e){e.preventDefault(),h.method=u;var t={nameError:"",profileNameError:"",emailError:"",passwordError:"",DOBError:"",userSummaryError:""};O(r,t,u)?fetch("/api/v1/public/register",h).then((function(e){e.json().then((function(t){if(200===e.status){var r=t.data;console.log(r),f.push("/login")}else{var a=t.error;b({type:u,preprocessed:!0,status:e.status,payload:a})}}))})):b({type:u,preprocessed:!1,status:422,payload:t})},children:[Object(v.jsx)("div",{className:"col-md-12 my-4 mx-auto",children:Object(v.jsx)("h5",{children:"Register"})}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formName",children:[Object(v.jsx)(x.a.Label,{children:"Name"}),Object(v.jsx)(x.a.Control,{id:"name",name:"name",type:"text",placeholder:"Enter your name",value:r.name,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.nameError,onChange:c}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.nameError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formEmail",children:[Object(v.jsx)(x.a.Label,{children:"Email address"}),Object(v.jsx)(x.a.Control,{id:"email",name:"email",type:"email",placeholder:"Enter email",value:r.email,onChange:c,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.emailError}),Object(v.jsx)(x.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.emailError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formProfileName",children:[Object(v.jsx)(x.a.Label,{children:"Profile Name"}),Object(v.jsx)(x.a.Control,{id:"profileName",name:"profileName",type:"text",placeholder:"Enter a name you would like to chose for your profile",value:r.profileName,onChange:c,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.profileNameError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.profileNameError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formPassword",children:[Object(v.jsx)(x.a.Label,{children:"Password"}),Object(v.jsx)(x.a.Control,{id:"password",name:"password",type:"password",placeholder:"Password",value:r.password,onChange:c,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.passwordError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.passwordError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formDOB",children:[Object(v.jsx)(x.a.Label,{children:"Date of Birth"}),Object(v.jsx)(x.a.Control,{id:"dob",name:"dob",type:"date",value:r.dob?new Date(r.dob).toISOString().substr(0,10):"",onChange:c,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.DOBError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.DOBError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formUserSummary",children:[Object(v.jsx)(x.a.Label,{children:"Something about yourself"}),Object(v.jsx)(x.a.Control,{id:"userSummary",name:"userSummary",as:"textarea",rows:3,value:r.userSummary,onChange:c})]}),Object(v.jsx)(x.a.Group,{as:g.a,md:12,children:Object(v.jsx)(y.a,{variant:"secondary",className:"my-3",type:"submit",children:"Submit"})}),Object(v.jsx)(x.a.Group,{as:g.a,md:12,children:Object(v.jsx)("button",{className:"my-3 link-button",type:"submit",onClick:function(){return f.push("/login")},children:"Already registered? Click here to login"})}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.postprocessingState.failureDetails.failureMessage}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.postprocessingState.failureDetails.details})]}),Object(v.jsxs)("div",{className:"col-md-8 mx-auto my-3 text-danger",children:[j.postprocessingState.failureDetails.failureMessage,j.postprocessingState.failureDetails.details]})]})})})})})),S=r(13),k=r.n(S),E=function(e,t){var r=!0;if(""===e.username)t.usernameError="Field can't be empty",r=!1;else{/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.username).toLowerCase())||(t.usernameError="Incorrect username format",r=!1)}if(""===e.password)t.passwordError="Field can't be empty",r=!1;else{/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/.test(String(e.password))||(t.passwordError="Incorrect password format",r=!1)}return console.log("enetered is valid ",r),r},C=Object(d.h)((function(){var e={hasError:!1,preprocessingState:{isSuccess:!0,failureDetails:{fieldErrors:{usernameError:"",passwordError:""}}},postprocessingState:{isSuccess:!0,failureDetails:{failureMessage:"",details:[]}}},t=Object(a.useState)({username:"",password:""}),r=Object(o.a)(t,2),n=r[0],c=r[1],s=Object(a.useState)(e),d=Object(o.a)(s,2),j=d[0],b=d[1];Object(a.useEffect)((function(){k.a.load("jwt")&&f.push("/")}));var m={method:u,headers:{"Content-Type":"application/json",Authorization:""},body:JSON.stringify(Object(l.a)({},n))},p=function(e){var t=e.target.name,r=e.target.value;c(Object(l.a)(Object(l.a)({},n),{},Object(i.a)({},t,r)))};return Object(v.jsx)("div",{style:{height:"60rem"},children:Object(v.jsx)("div",{className:"row h-100",children:Object(v.jsxs)("div",{className:"col-md-4 mx-auto my-auto rounded shadow bg-white",children:[Object(v.jsx)("div",{className:"col-md-4 mx-auto mt-3",children:Object(v.jsx)("h3",{children:"Citizen Sane"})}),Object(v.jsxs)(x.a,{noValidate:!0,onSubmit:function(e){e.preventDefault();var t={usernameError:"",passwordError:""};E(n,t)?fetch("/api/v1/public/login",m).then((function(e){e.json().then((function(t){if(200===e.status){var r=t.data,a=e.headers.get("Authorization");console.log(e),console.log(e.headers),e.headers.forEach((function(e,t){return console.log("value is ",e,"key is ",t)})),console.log(a);var n=new Date;n.setDate(n.getDate()+7),k.a.save("jwt",a,{path:"/",expires:n}),k.a.save("current_user",r,{path:"/",expires:n}),f.push("/")}else{var c=t.error;b(Object(l.a)(Object(l.a)({},j),{},{hasError:!0,preprocessingState:Object(l.a)(Object(l.a)({},j.preprocessingState),{},{failureDetails:Object(l.a)(Object(l.a)({},j.preprocessingState.failureDetails),{},{fieldErrors:{usernameError:"",passwordError:""}}),isSuccess:!0}),postprocessingState:Object(l.a)(Object(l.a)({},j.postprocessingState),{},{isSuccess:!1,failureDetails:{failureMessage:c.message,details:c.details}})}))}}))})):b(Object(l.a)(Object(l.a)({},j),{},{hasError:!0,preprocessingState:Object(l.a)(Object(l.a)({},j.preprocessingState),{},{isSuccess:!1,failureDetails:{fieldErrors:t}})}))},children:[Object(v.jsx)("div",{className:"col-md-12 my-4 mx-auto",children:Object(v.jsx)("h5",{children:"Login"})}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formUsername",children:[Object(v.jsx)(x.a.Label,{children:"Username"}),Object(v.jsx)(x.a.Control,{id:"username",name:"username",type:"email",placeholder:"Enter the email id you logged in with",value:n.username,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.usernameError,onChange:p}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.usernameError})]}),Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formPassword",children:[Object(v.jsx)(x.a.Label,{children:"Password"}),Object(v.jsx)(x.a.Control,{id:"password",name:"password",type:"password",placeholder:"Password",value:n.password,onChange:p,isInvalid:j.hasError&&""!==j.preprocessingState.failureDetails.fieldErrors.passwordError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:j.preprocessingState.failureDetails.fieldErrors.passwordError})]}),Object(v.jsx)(x.a.Group,{as:g.a,md:12,children:Object(v.jsx)(y.a,{variant:"secondary",className:"my-3",type:"submit",children:"Submit"})}),Object(v.jsx)(x.a.Group,{as:g.a,md:12,children:Object(v.jsx)("button",{className:"my-3 link-button",type:"submit",onClick:function(){return f.push("/register")},children:"Register yourself"})})]}),Object(v.jsxs)("div",{className:"col-md-8 mx-auto my-3 text-danger",children:[j.postprocessingState.failureDetails.failureMessage,j.postprocessingState.failureDetails.details]})]})})})})),N=(r(278),r(265)),T={isSuccess:!1,successDetails:{successMessage:"",resourceId:-1},failureDetails:{failureMessage:"",detials:[]}},I={hasError:!1,preprocessingState:{isSuccess:!1,failureDetails:{fieldErrors:{idError:"",nameError:"",emailError:"",profileNameError:"",passwordError:"",DOBError:"",userSummaryError:""}}},postprocessingState:T},L=function(){var e={editTriggered:!1,editOtherTriggered:!1,editEmailTriggered:!1,editPasswordTriggered:!1},t=Object(a.useContext)(Ee),r=(t.isCurrentUserUpdated,t.setIsCurrentUserUpdated),n=k.a.load("jwt"),c=k.a.load("current_user"),s=Object(a.useState)({id:null,name:"",email:"",password:"",profileName:"",dob:"",userSummary:""}),u=Object(o.a)(s,2),b=u[0],p=u[1],h=Object(a.useState)(!1),w=Object(o.a)(h,2),S=w[0],E=w[1],C=Object(a.useState)(!0),N=Object(o.a)(C,2),T=(N[0],N[1]),L=Object(a.useState)(e),D=Object(o.a)(L,2),P=D[0],A=D[1],B=Object(d.g)().id;Object(a.useEffect)((function(){!function(){var e={headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}};fetch("/api/v1/profile/".concat(B),e).then((function(e){return e.json().then((function(t){if(200===e.status){var r=t.data;p(r),T(!1),console.log(b)}else{var a=t.error;console.log(a),f.push("/error")}}))})).catch((function(e){console.log(e),f.push("/error")})),c.id===parseInt(B)&&E(!0)}()}),[]);var R=function(e){var t=e.target.name,r=e.target.value,a=Object(l.a)(Object(l.a)({},b),{},Object(i.a)({},t,r));p(a)},F=Object(a.useReducer)(m,I),U=Object(o.a)(F,2),M=U[0],G=U[1];return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{style:{height:"50rem"},children:Object(v.jsx)("div",{className:"row h-100",children:Object(v.jsxs)("div",{className:"col-md-4 mx-auto my-auto rounded shadow bg-white",children:[Object(v.jsxs)(x.a,{noValidate:!0,onSubmit:function(t){t.preventDefault();var a={method:j,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(Object(l.a)({},b))},s={nameError:"",profileNameError:"",passwordError:"",DOBError:"",userSummaryError:""};O(b,s,j)?!0===P.editOtherTriggered?fetch("/api/v1/profile/{profileId}",a).then((function(t){t.json().then((function(a){if(200===t.status){var n=a.data,s=Object(l.a)(Object(l.a)({},c),{},{name:b.name,userSummary:b.userSummary,profileName:b.profileName}),o=new Date;o.setDate(o.getDate()+7),k.a.save("current_user",s,{path:"/",expires:o}),r(!0),G({type:j,preprocessed:!0,status:t.status,payload:n}),A(e),f.push("/",{showAlert:!0,alertMessage:"Your profile has been updated successfully"})}else{var i=a.error;G({type:j,preprocessed:!0,status:t.status,payload:i})}}))})):!0===P.editEmailTriggered||P.editPasswordTriggered:G({type:null,preprocessed:!1,status:-1,payload:s})},children:[Object(v.jsx)("div",{className:"col-md-12 my-4 mx-auto",children:Object(v.jsx)("h5",{children:"User details"})}),!0===P.editTriggered&&!0===P.editOtherTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formName",children:[Object(v.jsx)(x.a.Label,{children:"Name"}),Object(v.jsx)(x.a.Control,{id:"name",name:"name",type:"text",placeholder:"Enter your name",value:b.name,isInvalid:M.hasError&&""!==M.preprocessingState.failureDetails.fieldErrors.nameError,onChange:R}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:M.preprocessingState.failureDetails.fieldErrors.nameError})]}):!1===P.editTriggered&&Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("div",{className:"row my-2",children:[Object(v.jsx)("div",{className:"col-md-6",children:"Name:"}),Object(v.jsx)("div",{className:"col-md-6",children:b.name})]})}),!0===P.editTriggered&&!0===P.editEmailTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formEmail",children:[Object(v.jsx)(x.a.Label,{className:"h5",children:"Email address:"}),Object(v.jsx)(x.a.Control,{id:"email",name:"email",type:"email",placeholder:"Enter email",value:b.email,onChange:R,isInvalid:M.hasError&&""!==M.preprocessingState.failureDetails.fieldErrors.emailError}),Object(v.jsx)(x.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:M.preprocessingState.failureDetails.fieldErrors.emailError})]}):!1===P.editTriggered&&Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("div",{className:"row my-2",children:[Object(v.jsx)("div",{className:"col-md-6",children:"Email:"}),Object(v.jsx)("div",{className:"col-md-6",children:b.email})]})}),!0===P.editTriggered&&!0===P.editPasswordTriggered&&Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formPassword",children:[Object(v.jsx)(x.a.Label,{className:"h5",children:"New Password:"}),Object(v.jsx)(x.a.Control,{id:"password",name:"password",type:"password",value:b.password,onChange:R,isInvalid:M.hasError&&""!==M.preprocessingState.failureDetails.fieldErrors.passwordError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:M.preprocessingState.failureDetails.fieldErrors.emailError})]}),!0===P.editTriggered&&!0===P.editOtherTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formProfileName",children:[Object(v.jsx)(x.a.Label,{children:"Profile Name"}),Object(v.jsx)(x.a.Control,{id:"profileName",name:"profileName",type:"text",placeholder:"Enter a name you would like to chose for your profile",value:b.profileName,onChange:R,isInvalid:M.hasError&&""!==M.preprocessingState.failureDetails.fieldErrors.profileNameError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:M.preprocessingState.failureDetails.fieldErrors.profileNameError})]}):!1===P.editTriggered&&Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("div",{className:"row my-2",children:[Object(v.jsx)("div",{className:"col-md-6",children:"Profile Name:"}),Object(v.jsx)("div",{className:"col-md-6",children:b.profileName})]})}),!0===P.editTriggered&&!0===P.editOtherTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formDOB",children:[Object(v.jsx)(x.a.Label,{children:"Date of Birth"}),Object(v.jsx)(x.a.Control,{id:"dob",name:"dob",type:"date",value:b.dob?new Date(b.dob).toISOString().substr(0,10):"",onChange:R,isInvalid:M.hasError&&""!==M.preprocessingState.failureDetails.fieldErrors.DOBError}),Object(v.jsx)(x.a.Control.Feedback,{type:"invalid",children:M.hasError&&M.preprocessingState.failureDetails.fieldErrors.DOBError})]}):!1===P.editTriggered&&Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("div",{className:"row my-2",children:[Object(v.jsx)("div",{className:"col-md-6",children:"Date of Birth:"}),Object(v.jsx)("div",{className:"col-md-6",children:b.dob})]})}),!0===P.editTriggered&&!0===P.editOtherTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,controlId:"formUserSummary",children:[Object(v.jsx)(x.a.Label,{children:"Something about yourself"}),Object(v.jsx)(x.a.Control,{id:"userSummary",name:"userSummary",as:"textarea",rows:3,value:b.userSummary,onChange:R})]}):!1===P.editTriggered&&Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("div",{className:"row my-2",children:[Object(v.jsx)("div",{className:"col-md-6",children:"Profile Summary:"}),Object(v.jsx)("div",{className:"col-md-6",children:b.userSummary})]})}),!0===P.editTriggered?Object(v.jsxs)(x.a.Group,{as:g.a,md:12,children:[Object(v.jsx)(y.a,{className:"my-3 mr-2",type:"submit",children:"Update"}),Object(v.jsx)(y.a,{className:"my-3 ml-2",type:"clear",children:"Clear"})]}):S?Object(v.jsx)(x.a.Group,{as:g.a,md:12,children:Object(v.jsxs)("div",{className:"row",children:[Object(v.jsx)("button",{className:"col-md col-sm col-lg p-0 link-button",type:"button",onClick:function(){return A(Object(l.a)(Object(l.a)({},P),{},{editTriggered:!0,editOtherTriggered:!0}))},children:"update your details"}),Object(v.jsx)("button",{className:"col-md col-sm col-lg p-0 link-button",type:"button",onClick:function(){return A(Object(l.a)(Object(l.a)({},P),{},{editTriggered:!0,editEmailTriggered:!0}))},children:"Change Email ID"}),Object(v.jsx)("button",{className:"col-md col-sm col-lg p-0 link-button",type:"button",onClick:function(){return A(Object(l.a)(Object(l.a)({},P),{},{editTriggered:!0,editPasswordTriggered:!0}))},children:"Change Password"})]})}):Object(v.jsx)(v.Fragment,{})]}),!0===P.editTriggered||!0===P.editEmailTriggered||!0===P.editPasswordTriggered&&Object(v.jsxs)("div",{className:"col-md-8 mx-auto my-3 text-danger",children:[M.postprocessingState.failureDetails.failureMessage,M.postprocessingState.failureDetails.details]})]})})})})},D=Object(d.h)((function(){return Object(v.jsx)(v.Fragment,{children:"There was an error"})})),P=r(42),A=r(11),B=r.n(A),R=r(23),F=r(27),U=r.n(F),M=function(){var e=Object(R.a)(B.a.mark((function e(t){var r,a,n,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=k.a.load("jwt"),k.a.load("current_user"),a={method:"GET",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}},e.prev=3,e.next=6,fetch("/api/v1/resource/posts/".concat(t),a);case 6:return n=e.sent,e.next=9,n.json();case 9:return c=e.sent,e.abrupt("return",c);case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),f.push("/error");case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(R.a)(B.a.mark((function e(t,r,a,n){var c,s,o,i,d,m,p;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=k.a.load("jwt"),s=k.a.load("current_user"),o={postHeading:a,postBody:n,owner:s},i={method:t,headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"}},d=null,e.t0=t,e.next=e.t0===u?8:e.t0===j?11:e.t0===b?14:15;break;case 8:return i.body=JSON.stringify(Object(l.a)(Object(l.a)({},o),{},{postedAtTime:U.a.utc().toISOString()})),d="/api/v1/resource/post",e.abrupt("break",15);case 11:return i.body=JSON.stringify(Object(l.a)(Object(l.a)({},o),{},{id:r,modifiedAtTime:U.a.utc().toISOString()})),d="/api/v1/resource/post",e.abrupt("break",15);case 14:d="/api/v1/resource/post/".concat(r);case 15:return e.prev=15,e.next=18,fetch(d,i);case 18:return m=e.sent,e.next=21,m.json();case 21:return p=e.sent,e.abrupt("return",p);case 25:e.prev=25,e.t1=e.catch(15),console.log(e.t1),f.push("/error");case 29:case"end":return e.stop()}}),e,null,[[15,25]])})));return function(t,r,a,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(R.a)(B.a.mark((function e(t,r){var a,n,c,s,o,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.a.load("jwt"),n=k.a.load("current_user"),c={owner:n,likedAtTime:U.a.utc().toISOString(),likedPost:{id:t.id}},s={method:"like"===r?"POST":"DELETE",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(Object(l.a)({},c))},e.prev=4,e.next=7,fetch("/api/v1/resource/post/".concat(t.id,"/").concat(r),s);case 7:return o=e.sent,e.next=10,o.json();case 10:return i=e.sent,e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),f.push("/error");case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t,r){return e.apply(this,arguments)}}(),_=function(){var e=Object(R.a)(B.a.mark((function e(t,r,a,n,c){var s,o,i,d,m,p,O;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=k.a.load("jwt"),o=k.a.load("current_user"),i={commentedOn:{id:a},commentContent:c,owner:o},r&&(i=Object(l.a)(Object(l.a)({},i),{},{parentComment:{id:r}})),d={method:t,headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}},m=null,e.t0=t,e.next=e.t0===u?9:e.t0===j?12:e.t0===b?16:17;break;case 9:return d.body=JSON.stringify(Object(l.a)(Object(l.a)({},i),{},{commentedAtTime:U.a.utc().toISOString()})),m="/api/v1/resource/comment",e.abrupt("break",17);case 12:return i=Object(l.a)(Object(l.a)({},i),{},{id:n,modifiedAtTime:U.a.utc().toISOString()}),d.body=JSON.stringify(Object(l.a)({},i)),m="/api/v1/resource/comment",e.abrupt("break",17);case 16:m="/api/v1/resource/comment/".concat(n);case 17:return e.prev=17,e.next=20,fetch(m,d);case 20:return p=e.sent,e.next=23,p.json();case 23:return O=e.sent,e.abrupt("return",O);case 27:e.prev=27,e.t1=e.catch(17),console.log(e.t1),f.push("/error");case 31:case"end":return e.stop()}}),e,null,[[17,27]])})));return function(t,r,a,n,c){return e.apply(this,arguments)}}(),z=function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,c,s,o,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=k.a.load("jwt"),k.a.load("current_user"),c={method:"GET",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}},s=null,s=r?"/api/v1/resource/comment/".concat(r,"/replies/").concat(a):"/api/v1/resource/post/".concat(t,"/comments/").concat(a),e.prev=5,e.next=8,fetch(s,c);case 8:return o=e.sent,e.next=11,o.json();case 11:return i=e.sent,e.abrupt("return",i);case 15:e.prev=15,e.t0=e.catch(5),f.push("/error");case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,r,a){return e.apply(this,arguments)}}(),Y=function(){var e=Object(R.a)(B.a.mark((function e(t,r){var a,n,c,s,o,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.a.load("jwt"),n=k.a.load("current_user"),c={owner:n,likedAtTime:U.a.utc().toISOString(),likedComment:{id:t.id}},s={method:"like"===r?"POST":"DELETE",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(Object(l.a)({},c))},e.prev=4,e.next=7,fetch("/api/v1/resource/comment/".concat(t.id,"/").concat(r),s);case 7:return o=e.sent,e.next=10,o.json();case 10:return i=e.sent,e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0),f.push("/error");case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t,r){return e.apply(this,arguments)}}(),J=r(261),K=r(530),$=r(526),V=r(36),W=r(88),Z=r(58),q=r(525),Q=r(528),X=r(94);function ee(e){var t=e.owner;e.dateString;return Object(v.jsx)(q.a,{placement:"top",overlay:Object(v.jsxs)(Q.a,{id:"popover-positioned-top",children:[Object(v.jsx)(Q.a.Title,{as:"h3",children:t.name}),Object(v.jsx)(Q.a.Content,{children:t.userSummary})]}),children:Object(v.jsx)("div",{style:{display:"inline-block"},children:Object(v.jsx)("cite",{children:Object(v.jsx)(X.a,{className:"text-secondary",to:"/profile/".concat(t.id),children:t.name})})})},"top")}var te=r(523),re=r(531),ae=function(){var e=Object(R.a)(B.a.mark((function e(t,r){var a,n,c,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.a.load("jwt"),k.a.load("current_user"),n={method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}},e.prev=3,e.next=6,fetch("/api/v1/resource/post/".concat(t,"/likes"),n);case 6:return c=e.sent,e.next=9,c.json();case 9:return s=e.sent,e.abrupt("return",s);case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),f.push("/error");case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t,r){return e.apply(this,arguments)}}(),ne=function(){var e=Object(R.a)(B.a.mark((function e(t,r){var a,n,c,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.a.load("jwt"),k.a.load("current_user"),n={method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}},e.prev=3,e.next=6,fetch("/api/v1/resource/comment/".concat(t,"/likes"),n);case 6:return c=e.sent,e.next=9,c.json();case 9:return s=e.sent,e.abrupt("return",s);case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),f.push("/error");case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t,r){return e.apply(this,arguments)}}(),ce=function(e){var t=e.itemId,r=e.itemType,n=e.setShow,c=e.show,s=Object(a.useState)({dataList:[],currentPageNo:0,noOfPages:0}),i=Object(o.a)(s,2),l=i[0],d=i[1],u=function(){return n(!1)};return Object(a.useEffect)((function(){!0===c&&Object(R.a)(B.a.mark((function e(){var a,n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=null,"POST"!==r){e.next=8;break}return e.next=5,ae(t,0);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,ne(t,0);case 10:a=e.sent;case 11:"error"in a?(n=a.error,console.log(n),f.push("/error")):(console.log(a),d(a)),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),f.push("/error");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))()}),[]),Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(te.a,{size:"lg",show:c,onHide:u,centered:!0,children:[Object(v.jsx)(te.a.Header,{closeButton:!0,children:Object(v.jsx)(te.a.Title,{})}),Object(v.jsx)(te.a.Body,{className:"p-0",children:Object(v.jsx)(K.a,{children:Object(v.jsx)(re.a,{variant:"flush",children:l.dataList.map((function(e){return Object(v.jsx)(re.a.Item,{children:Object(v.jsx)("div",{className:"col-md",children:Object(v.jsx)(ee,{owner:e.owner})})})}))})})}),Object(v.jsx)(te.a.Footer,{children:Object(v.jsx)(y.a,{variant:"secondary",onClick:u,children:"Close"})})]})})},se=function(e){var t=U.a.utc(e),r=U.a.utc(),a=Math.abs(t.diff(r,"days")),n=Math.abs(t.diff(r,"months"));return a<1?t.from(r):a>=1&&a<7?U()(e).local().format("dddd HH:mm A"):n<12?U()(e).local().format("dddd, MMM Do"):U()(e).local().format("dddd, MMM Do YYYY")},oe=n.a.memo((function(e){var t=e.postId,r=e.parentCommentId,n=e.comment,c=e.setParentComments,s=e.setNoOfRepliesInParent,d=k.a.load("current_user"),m=Object(a.useState)(n.noOfLikes),p=Object(o.a)(m,2),O=p[0],h=p[1],g=Object(a.useState)(n.noOfReplies),w=Object(o.a)(g,2),S=w[0],E=w[1],C=Object(a.useState)(n.commentLikedByCurrentUser),N=Object(o.a)(C,2),T=N[0],I=N[1],L=Object(a.useState)({}),D=Object(o.a)(L,2),A=D[0],F=D[1],M=Object(a.useState)(""),G=Object(o.a)(M,2),H=G[0],J=G[1],q=Object(a.useState)(!1),Q=Object(o.a)(q,2),X=Q[0],te=Q[1],re=Object(a.useState)(!1),ae=Object(o.a)(re,2),ne=ae[0],ie=ae[1],le=Object(a.useRef)(null),de=Object(a.useRef)(null),ue=Object(a.useRef)(null),je=Object(a.useRef)(null),be=Object(a.useRef)(null),me=Object(a.useRef)(null),pe=Object(a.useRef)(null),Oe=Object(a.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,o,m,p,O,h,x,g,y,v;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.postId,o=a.commentId,m=a.commentContent,p="post".concat(n).trim(),t.preventDefault(),e.t0=r,e.next=e.t0===j?8:e.t0===b?16:20;break;case 8:if(""!==m){e.next=11;break}e.next=15;break;case 11:return e.next=13,_(r,null,n,o,m);case 13:"error"in(O=e.sent)?(h=O.error,console.log(h),f.push("/error")):(x=O.data,g={id:x.resourceId,commentedOn:{id:n},commentContent:m,owner:d,commentLikedByCurrentUser:!1,noOfLikes:0,noOfReplies:0},g=Object(l.a)(Object(l.a)({},g),{},{modifiedAtTime:U.a.utc().toISOString()}),c((function(e){var t=r===u?[].concat(Object(P.a)(e[p].dataList),[g]):e[p].dataList.map((function(e){return e.id===o?g:e}));return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},p,Object(l.a)(Object(l.a)({},e[p]),{},{dataList:t})))})));case 15:return e.abrupt("break",20);case 16:return e.next=18,_(r,null,n,o,null);case 18:"error"in(y=e.sent)?(v=y.error,console.log(v),f.push("/error")):(c((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},p,Object(l.a)(Object(l.a)({},e["post".concat(n)]),{},{dataList:e["post".concat(n)].dataList.filter((function(e){return e.id!==o}))})))})),s((function(e){return e-1})));case 20:J("");case 21:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),[]),he=Object(a.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,o,m,p,O,h,x,g,y,v,w,k,C,N;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.parentCommentId,o=a.postId,m=a.commentId,p=a.replyContent,O="comment".concat(n).trim(),t.preventDefault(),e.t0=r,e.next=e.t0===u?9:e.t0===j?17:e.t0===b?26:30;break;case 9:if(p&&void 0!==p&&""!==p){e.next=12;break}e.next=16;break;case 12:return e.next=14,_(r,n,o,m,p);case 14:"error"in(h=e.sent)?(x=h.error,console.log(x),f.push("/error")):(g=h.data,A&&A[O]&&(y={id:g.resourceId,commentedOn:{id:o},parentComment:{id:n},commentedAtTime:U.a.utc().toISOString(),commentContent:p,owner:d,commentLikedByCurrentUser:!1,noOfLikes:0,noOfReplies:0},v=[].concat(Object(P.a)(A[O].dataList),[y]),F(Object(l.a)(Object(l.a)({},A),{},Object(i.a)({},O,Object(l.a)(Object(l.a)({},A[O]),{},{dataList:v}))))),E(S+1),A&&A[O]||be.current.click());case 16:return e.abrupt("break",30);case 17:if(""!==p&&void 0!==p&&null!==p){e.next=21;break}alert("comment cant be empty"),e.next=25;break;case 21:return e.next=23,_(r,n,o,m,p);case 23:"error"in(w=e.sent)?(k=w.error,console.log(k),f.push("/error")):c((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},O,Object(l.a)(Object(l.a)({},e[O]),{},{dataList:e[O].dataList.map((function(e){return e.id===m?Object(l.a)(Object(l.a)({},e),{},{commentContent:p,modifiedAtTime:U.a.utc().toISOString()}):e}))})))}));case 25:return e.abrupt("break",30);case 26:return e.next=28,_(r,n,o,m,p);case 28:"error"in(C=e.sent)?(N=C.error,console.log(N),f.push("/error")):(c((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},O,Object(l.a)(Object(l.a)({},e["comment".concat(n)]),{},{dataList:e["comment".concat(n)].dataList.filter((function(e){return e.id!==m}))})))})),s&&s((function(e){return e-1})));case 30:J("");case 31:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),[A,S]),fe=function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(r,a);case 2:"error"in(n=e.sent)?(c=n.error,console.log(c),f.push("/error")):(I("like"===a),h("like"===a?O+1:O-1));case 4:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),xe=Object(a.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(r,a,n){var c,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c="comment".concat(a).trim(),!t){e.next=7;break}return e.next=4,z(null,a,n);case 4:"error"in(s=e.sent)?(s.error,f.push("/error")):A[c]?A[c].currentPageNo!=n&&F(Object(l.a)(Object(l.a)({},A),{},Object(i.a)({},c,{currentPageNo:s.currentPageNo,noOfPages:s.noOfPages,dataList:[].concat(Object(P.a)(A[c].dataList),Object(P.a)(s.dataList))}))):F(Object(l.a)(Object(l.a)({},A),{},Object(i.a)({},c,s))),ie(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),[A,ne]),ge=function(e,t){switch(t){case"REPLY":le.current.style.display="block",de.current.style.display="none",me.current.value="",me.current.focus();break;case"REPLY_SUBMIT":le.current.style.display="none",de.current.style.display="inline-block";break;case"UPDATE":je.current.style.display="none",ue.current.style.display="inline-block",pe.current.focus(),de.current.style.display="none";break;case"UPDATE_SUBMIT":je.current.style.display="inline-block",ue.current.style.display="none",de.current.style.display="inline-block"}},ye=function(e,t){switch(t){case"REPLY_SUBMIT":"Escape"===e.key&&(le.current.style.display="none",de.current.style.display="inline-block");break;case"UPDATE_SUBMIT":"Escape"===e.key&&(ue.current.style.display="none",je.current.style.display="inline-block",de.current.style.display="inline-block")}};return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:(r?"pl-4 ":"")+" bg-light",children:[Object(v.jsxs)("div",{className:r?"p-0 m-0 border-left":"",children:[!0===X&&Object(v.jsx)(ce,{itemId:n.id,itemType:"COMMENT",setShow:te,show:X}),Object(v.jsx)(K.a,{id:"commentCard".concat(n.id),style:{maxWidth:"100%",border:"none"},bg:"light",children:Object(v.jsxs)(K.a.Body,{children:[Object(v.jsx)(K.a.Subtitle,{children:Object(v.jsxs)("div",{className:"pb-4",children:[Object(v.jsx)(ee,{owner:n.owner}),Object(v.jsx)("div",{className:"my-1",children:Object(v.jsx)("button",{className:"link-button",children:Object(v.jsx)("small",{children:(n.modifiedAtTime?"Modified: ":"Posted: ")+"".concat(se(n.modifiedAtTime?n.modifiedAtTime:n.commentedAtTime))})})})]})}),Object(v.jsxs)(K.a.Text,{children:[Object(v.jsx)("div",{ref:je,style:{display:"inline-block"},children:n.commentContent}),Object(v.jsxs)("div",{ref:ue,style:{display:"none"},children:[Object(v.jsx)(x.a.Group,{controlId:"updateCommentBoxFor".concat(n.id),children:Object(v.jsx)(x.a.Control,{as:"textarea",rows:3,cols:100,id:"updateOn".concat(n.id),name:"updateOn".concat(n.id),onChange:function(e){return J(e.target.value)},ref:pe,value:H,onKeyDown:function(e){return ye(e,"UPDATE_SUBMIT")}})}),Object(v.jsx)(x.a.Group,{controlId:"updateCommentBoxFor".concat(n.id),children:Object(v.jsx)(y.a,{type:"button",id:"submitUpdateOn".concat(n.id),name:"submitUpdateOn".concat(n.id),onClick:function(e){r?he(e,j,{parentCommentId:r,postId:t,commentId:n.id,replyContent:H}):Oe(e,j,{postId:t,commentId:n.id,commentContent:H}),ge(0,"UPDATE_SUBMIT")},children:"update"})})]})]})]})}),Object(v.jsx)($.a,{children:Object(v.jsxs)(K.a,{style:{maxWidth:"100%",border:"none"},children:[Object(v.jsxs)(K.a.Header,{style:{border:"none"},children:[Object(v.jsxs)("div",{ref:de,className:"p-1",style:{display:"block"},children:[O>0&&Object(v.jsx)("div",{className:"mb-3",children:Object(v.jsx)("button",{className:"link-button",onClick:function(e){te(!0)},children:Object(v.jsx)("small",{children:"View likes"})})}),void 0===T||null===T||!1===T?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(V.a,{onClick:function(e){return n.owner.id!==d.id&&fe(e,n,"like")},icon:Z.c,style:n.owner.id!==d.id?{marginRight:"0.5rem",cursor:"pointer"}:{marginRight:"0.5rem",opacity:.4}}),Object(v.jsx)("span",{style:{color:"grey",marginRight:"1rem"},children:O})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(V.a,{onClick:function(e){return fe(e,n,"unlike")},icon:W.b,style:{marginRight:"0.5rem",cursor:"pointer"}}),Object(v.jsx)("span",{style:{color:"grey",marginRight:"1rem"},children:O})]}),S>0?Object(v.jsx)(v.Fragment,{children:Object(v.jsx)($.a.Toggle,{as:y.a,variant:"link",eventKey:"comment".concat(n.id),onClick:function(e){A["comment".concat(n.id)]||(ie(!0),xe(e,n.id,0))},ref:be,className:"p-0 border-0",children:Object(v.jsx)(V.a,{icon:Z.a,color:"black",style:{marginLeft:"1rem",marginRight:"1rem"}})})}):Object(v.jsx)(v.Fragment,{}),Object(v.jsx)(V.a,{onClick:function(e){ge(0,"REPLY")},icon:W.a,style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"}}),n.owner.id===d.id&&Object(v.jsx)(V.a,{icon:Z.b,style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"},onClick:function(e){J(n.commentContent),ge(0,"UPDATE")}}),n.owner.id===d.id&&Object(v.jsx)(V.a,{onClick:function(e){r?he(e,b,{parentCommentId:r,postId:t,commentId:n.id}):Oe(e,b,{postId:t,commentId:n.id})},icon:Z.d,style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"}})]}),Object(v.jsxs)("div",{ref:le,style:{display:"none"},children:[Object(v.jsx)(x.a.Group,{controlId:"replyBoxFor".concat(n.id),children:Object(v.jsx)(x.a.Control,{as:"textarea",rows:3,cols:100,id:"replyOn".concat(n.id),name:"replyOn".concat(n.id),ref:me,onChange:function(e){return J(e.target.value)},onKeyDown:function(e){return ye(e,"REPLY_SUBMIT")}})}),Object(v.jsx)(x.a.Group,{controlId:"replyBoxFor".concat(n.id),children:Object(v.jsx)(y.a,{type:"submit",id:"submitReplyOn".concat(n.id),name:"submitReplyOn".concat(n.id),onClick:function(e){he(e,u,{parentCommentId:n.id,postId:t,commentId:null,replyContent:H}),ge(0,"REPLY_SUBMIT")},children:"reply"})})]})]}),S>0?Object(v.jsx)($.a.Collapse,{eventKey:"comment".concat(n.id),children:Object(v.jsxs)(K.a.Body,{className:"p-0",children:[!0===ne&&Object(v.jsxs)("div",{className:"spinner bg-light",children:[Object(v.jsx)("div",{className:"bounce1"}),Object(v.jsx)("div",{className:"bounce2"}),Object(v.jsx)("div",{className:"bounce3"})]}),A["comment".concat(n.id).trim()]&&A["comment".concat(n.id)].dataList.map((function(e,r){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(oe,{postId:t,parentCommentId:n.id,comment:e,setParentComments:F,setNoOfRepliesInParent:E},"reply".concat(e.id))})})),A["comment".concat(n.id).trim()]&&A["comment".concat(n.id)].currentPageNo<A["comment".concat(n.id)].noOfPages-1&&Object(v.jsx)("button",{className:"link-button",onClick:function(e){return xe(e,n.id,A["comment".concat(n.id)].currentPageNo+1)},children:"load more replies"})]})}):Object(v.jsx)(v.Fragment,{})]})})]}),console.log("rendering comment ",n.id)]})})})),ie=r(262),le=r(263),de=r.n(le),ue=(r(255),r(520)),je=r(257),be=n.a.memo((function(e){var t=e.setShow,r=e.show,n=e.method,c=e.setPosts,s=e.post,i=Object(a.useState)({id:null,postHeading:"",postBody:""}),d=Object(o.a)(i,2),b=d[0],m=d[1],p=(k.a.load("jwt"),k.a.load("current_user"));Object(a.useEffect)((function(){s&&!0===r&&m({id:s.id,postHeading:s.postHeading,postBody:s.postBody})}),[r]);var O=function(e){return t(!1)},h=function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,s,o,i,d,b;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.id,s=a.postHeading.trim(),o=a.postBody.trim(),""!==s&&""!==o){e.next=6;break}e.next=24;break;case 6:return e.next=8,G(r,n,s,o);case 8:if(!("error"in(i=e.sent))){e.next=16;break}d=i.error,console.log(d),O(),f.push("/error"),e.next=24;break;case 16:b=i.data,e.t0=r,e.next=e.t0===u?20:e.t0===j?23:24;break;case 20:return console.log("post getting executed"),c((function(e){return Object(l.a)(Object(l.a)({},e),{},{dataList:[{id:b.resourceId,owner:p,postHeading:s,postBody:o,postedAtTime:U.a.utc().toISOString(),modifiedAtTime:null,noOfComments:0,noOfLikes:0}].concat(Object(P.a)(e.dataList))})})),e.abrupt("break",24);case 23:c((function(e){return Object(l.a)(Object(l.a)({},e),{},{dataList:e.dataList.map((function(e){var t=e;return e.id===n?(""!==s&&(t=Object(l.a)(Object(l.a)({},t),{},{postHeading:s})),""!==o&&(t=Object(l.a)(Object(l.a)({},t),{},{postBody:o})),t=Object(l.a)(Object(l.a)({},t),{},{modifiedAtTime:U.a.utc().toISOString()})):e}))})}));case 24:O(),m({id:null,postHeading:"",postBody:""});case 26:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(te.a,{size:"lg",show:r,onHide:O,centered:!0,children:[Object(v.jsx)(te.a.Header,{closeButton:!0,children:Object(v.jsx)(te.a.Title,{})}),Object(v.jsx)(te.a.Body,{children:Object(v.jsxs)("div",{className:"row",children:[Object(v.jsx)("div",{className:"col-md-10 mx-auto",children:Object(v.jsxs)(ue.a,{children:[Object(v.jsx)(ue.a.Prepend,{children:Object(v.jsx)(ue.a.Text,{id:"basic-addon1",children:"@"})}),Object(v.jsx)(je.a,{placeholder:"PostHeading","aria-label":"PostHeading","aria-describedby":"basic-addon1",onChange:function(e){return m(Object(l.a)(Object(l.a)({},b),{},{postHeading:e.target.value}))},value:b.postHeading})]})}),Object(v.jsx)("div",{className:" mx-auto",children:Object(v.jsx)(ie.CKEditor,{editor:de.a,data:b.postBody,onReady:function(e){s&&e.setData(s.postBody)},onChange:function(e,t){var r=t.getData();m(Object(l.a)(Object(l.a)({},b),{},{postBody:r}))},onBlur:function(e,t){},onFocus:function(e,t){}})})]})}),Object(v.jsxs)(te.a.Footer,{children:[Object(v.jsx)(y.a,{variant:"secondary",onClick:O,children:"Close"}),Object(v.jsx)(y.a,{variant:"primary",onClick:function(e){return h(e,n,b)},children:n===j?"Update post":"Create post"})]})]})})})),me=new Set,pe=n.a.memo((function(e){var t=e.post,r=e.setPosts,n=k.a.load("current_user"),c=Object(a.useState)({}),s=Object(o.a)(c,2),d=s[0],m=s[1],p=Object(a.useState)(!1),O=Object(o.a)(p,2),h=O[0],g=O[1],w=Object(a.useState)(""),S=Object(o.a)(w,2),E=S[0],C=S[1],N=Object(a.useState)(t.noOfComments),T=Object(o.a)(N,2),I=T[0],L=T[1],D=Object(a.useState)(!1),A=Object(o.a)(D,2),F=A[0],M=A[1],Y=Object(a.useRef)(null),q=Object(a.useRef)(null),Q=Object(a.useRef)(null),X=Object(a.useRef)(null),te=function(){var e=Object(R.a)(B.a.mark((function e(t,a){var n,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,G(b,a,null,null);case 3:"error"in(n=e.sent)?(c=n.error,console.log(c),f.push("/error")):r((function(e){return Object(l.a)(Object(l.a)({},e),{},{dataList:e.dataList.filter((function(e){return e.id!==a}))})}));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),re=Object(a.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var c,s,o,p,O,h,x,g,y,v,w;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=a.postId,s=a.commentId,o=a.commentContent,p="post".concat(c).trim(),t.preventDefault(),e.t0=r,e.next=e.t0===u||e.t0===j?8:e.t0===b?16:21;break;case 8:if(""!==o){e.next=11;break}e.next=15;break;case 11:return e.next=13,_(r,null,c,s,o);case 13:"error"in(O=e.sent)?(h=O.error,console.log(h),f.push("/error")):(x=O.data,d&&d[p]&&(g={id:x.resourceId,commentedOn:{id:c},commentContent:o,owner:n,commentLikedByCurrentUser:!1,noOfLikes:0,noOfReplies:0},g=u===r?Object(l.a)(Object(l.a)({},g),{},{commentedAtTime:U.a.utc().toISOString(),modifiedAtTime:null}):Object(l.a)(Object(l.a)({},g),{},{modifiedAtTime:U.a.utc().toISOString()}),y=r===u?[].concat(Object(P.a)(d[p].dataList),[g]):d[p].dataList.map((function(e){return e.id===s?g:e})),m(Object(l.a)(Object(l.a)({},d),{},Object(i.a)({},p,Object(l.a)(Object(l.a)({},d[p]),{},{dataList:y}))))),u===r&&L(I+1));case 15:return e.abrupt("break",21);case 16:return e.next=18,_(r,null,c,s,null);case 18:"error"in(v=e.sent)?(w=v.error,console.log(w),f.push("/error")):(m(Object(l.a)(Object(l.a)({},d),{},Object(i.a)({},p,Object(l.a)(Object(l.a)({},d["post".concat(c)]),{},{dataList:d["post".concat(c)].dataList.filter((function(e){return e.id!==s}))})))),L(I-1)),me.add(m);case 21:C("");case 22:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),[d,I]),ae=Object(a.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(t,r,a){var n,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="post".concat(r).trim(),!r){e.next=6;break}return e.next=4,z(r,null,a);case 4:"error"in(c=e.sent)?(c.error,f.push("/error")):d[n]?d[n].currentPageNo!==a&&m(Object(l.a)(Object(l.a)({},d),{},Object(i.a)({},n,{currentPageNo:c.currentPageNo,noOfPages:c.noOfPages,dataList:[].concat(Object(P.a)(d[n].dataList),Object(P.a)(c.dataList))}))):m(Object(l.a)(Object(l.a)({},d),{},Object(i.a)({},n,c)));case 6:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),[d]),ne=function(){var e=Object(R.a)(B.a.mark((function e(t,a,n){var c,s,o;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(a,n);case 2:"error"in(c=e.sent)?(s=c.error,console.log(s),f.push("/error")):(o="like"===n,r((function(e){var t=e.dataList.map((function(e){if(e.id===a.id){var t="like"===n?e.noOfLikes+1:e.noOfLikes-1;return Object(l.a)(Object(l.a)({},e),{},{postLikedByCurrentUser:o,noOfLikes:t})}return e}));return Object(l.a)(Object(l.a)({},e),{},{dataList:t})})));case 4:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),ie=function(e,t){switch(t){case"REPLY":Y.current.style.display="block",q.current.style.display="none",Q.current.value="",Q.current.focus();break;case"REPLY_SUBMIT":Y.current.style.display="none",q.current.style.display="inline-block"}};return Object(v.jsxs)("div",{children:[!0===h&&Object(v.jsx)(be,{setShow:g,show:h,method:j,setPosts:r,post:t}),!0===F&&Object(v.jsx)(ce,{itemId:t.id,itemType:"POST",setShow:M,show:F}),Object(v.jsx)(K.a,{className:"mt-2",style:{maxWidth:"80%",borderBottom:"none"},children:Object(v.jsxs)(K.a.Body,{children:[Object(v.jsx)(K.a.Title,{className:"border-bottom pb-3",children:t.postHeading}),Object(v.jsx)(K.a.Subtitle,{children:Object(v.jsxs)("div",{className:"pb-4",children:[Object(v.jsx)(ee,{owner:t.owner}),Object(v.jsx)("div",{className:"my-1",children:Object(v.jsx)("button",{className:"link-button",children:Object(v.jsx)("small",{children:(t.modifiedAtTime?"Modified: ":"Posted: ")+"".concat(se(t.modifiedAtTime?t.modifiedAtTime:t.postedAtTime))})})})]})}),Object(v.jsx)(K.a.Text,{children:Object(v.jsx)("div",{style:{display:"inline-block"},children:Object(J.a)(t.postBody)})})]})}),Object(v.jsx)($.a,{children:Object(v.jsxs)(K.a,{style:{maxWidth:"80%",borderTop:"none"},children:[Object(v.jsxs)(K.a.Header,{style:{background:"none",border:"none",margin:"none"},children:[Object(v.jsxs)("div",{ref:q,style:{display:"inline-block"},children:[Object(v.jsx)("div",{className:"mb-3",children:t.noOfLikes>0&&Object(v.jsx)("button",{className:"link-button mr-3",onClick:function(e){M(!0)},children:Object(v.jsx)("small",{children:"View Likes"})})}),!1===t.postLikedByCurrentUser||void 0===t.postLikedByCurrentUser||null===t.postLikedByCurrentUser?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(V.a,{color:"#4A4A4A",onClick:function(e){return t.owner.id!==n.id&&ne(e,t,"like")},icon:Z.c,style:t.owner.id!==n.id?{marginRight:"0.5rem",cursor:"pointer"}:{marginRight:"0.5rem",opacity:.4}}),Object(v.jsx)("span",{style:{color:"#4A4A4A",marginRight:"1rem"},children:t.noOfLikes})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(V.a,{color:"#4A4A4A",onClick:function(e){return ne(e,t,"unlike")},icon:W.b,style:{marginRight:"0.5rem",cursor:"pointer"}}),Object(v.jsx)("span",{style:{color:"grey"},children:t.noOfLikes})]}),I>0&&Object(v.jsx)(v.Fragment,{children:Object(v.jsx)($.a.Toggle,{as:y.a,variant:"link",eventKey:"post".concat(t.id),onClick:function(e){return ae(e,t.id,0)},ref:X,className:"p-0 border-0",children:Object(v.jsx)(V.a,{icon:Z.a,color:"#4A4A4A",style:{marginLeft:"1rem",marginRight:"1rem"}})})}),Object(v.jsx)(V.a,{onClick:function(e){ie(0,"REPLY")},color:"#4A4A4A",icon:W.a,style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"}}),t.owner.id===n.id&&Object(v.jsx)(V.a,{icon:Z.b,color:"#4A4A4A",style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"},onClick:function(e){g(!0)}}),t.owner.id===n.id&&Object(v.jsx)(V.a,{onClick:function(e){te(e,t.id)},color:"#4A4A4A",icon:Z.d,style:{marginLeft:"1rem",marginRight:"1rem",cursor:"pointer"}})]}),Object(v.jsxs)("div",{ref:Y,style:{display:"none"},children:[Object(v.jsx)(x.a.Group,{controlId:"commentBoxFor".concat(t.id),children:Object(v.jsx)(x.a.Control,{as:"textarea",rows:3,cols:90,id:"commentOn".concat(t.id),name:"commentOn".concat(t.id),onChange:function(e){return C(e.target.value)},ref:Q,onKeyDown:function(e){!function(e){"Escape"===e.key&&(Y.current.style.display="none",q.current.style.display="inline-block")}(e)}})}),Object(v.jsx)(x.a.Group,{controlId:"replyBoxFor".concat(t.id),children:Object(v.jsx)(y.a,{type:"submit",id:"submitCommentOn".concat(t.id),name:"submitCommentOn".concat(t.id),onClick:function(e){re(e,u,{commentId:null,postId:t.id,commentContent:E}),ie(0,"REPLY_SUBMIT")},children:"reply"})})]})]}),I>0&&Object(v.jsx)($.a.Collapse,{eventKey:"post".concat(t.id),children:Object(v.jsxs)(K.a.Body,{children:[d["post".concat(t.id).trim()]&&d["post".concat(t.id)].dataList.map((function(e,r){return Object(v.jsx)(oe,{postId:t.id,parentCommentId:null,comment:e,setParentComments:m,setNoOfRepliesInParent:L},"comment".concat(e.id))})),d["post".concat(t.id).trim()]&&d["post".concat(t.id)].currentPageNo<d["post".concat(t.id)].noOfPages-1&&Object(v.jsx)("button",{className:"link-button",onClick:function(e){return ae(e,t.id,d["post".concat(t.id)].currentPageNo+1)},children:"load more comments"})]})})]})})]})})),Oe=r(521),he=function(e){var t=e.alertMessage,r=Object(a.useState)(!0),n=Object(o.a)(r,2),c=n[0],s=n[1];return Object(a.useEffect)((function(){setTimeout((function(){s(!1)}),3e3)})),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Oe.a,{style:{zIndex:"5000"},show:c,variant:"success",dismissible:!0,children:Object(v.jsx)("p",{children:t})})})},fe=n.a.memo((function(e){var t=e.setAddPostButtonClicked,r=e.addPostButtonClicked,n=f.location,c=!1,s=null;n&&n.state&&(c=n.state.showAlert,s=n.state.alertMessage);var i=Object(a.useRef)(),d=Object(a.useState)({currentPageNo:-1,noOfPages:-1,dataList:[]}),j=Object(o.a)(d,2),b=j[0],m=j[1];i.current=b;function p(){var e=document;return Math.max(e.body.scrollHeight,e.documentElement.scrollHeight,e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight)}Object(a.useEffect)((function(){return window.onbeforeunload=function(){!0===c&&f.replace({state:null}),document.body.style.display="none"},-1===i.current.currentPageNo&&Object(R.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M(0);case 3:"error"in(t=e.sent)?(console.log(t.error),f.push("/error")):(m(t),window.addEventListener("scroll",(function(e){return O(e)}))),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),f.push("/error");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))(),function(){!0===c&&(window.onbeforeunload=null),window.removeEventListener("scroll",(function(e){return O(e)}))}}),[]);var O=function(){var e=Object(R.a)(B.a.mark((function e(t){var r,a,n,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.scrollY+window.innerHeight!==p()){e.next=13;break}if(e.prev=1,!(i.current.currentPageNo<i.current.noOfPages)){e.next=7;break}return e.next=5,M(i.current.currentPageNo+1);case 5:"error"in(r=e.sent)?(console.log(r.error),f.push("/error")):(a=r.dataList,n=r.currentPageNo,c=r.noOfPages,m(Object(l.a)(Object(l.a)({},i.current),{},{dataList:[].concat(Object(P.a)(i.current.dataList),Object(P.a)(a)),currentPageNo:n,noOfPages:c})));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),f.push("/error");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[!0===c&&Object(v.jsx)(he,{alertMessage:s}),!0===r&&Object(v.jsx)(be,{setShow:t,show:r,method:u,setPosts:m,post:null}),Object(v.jsx)("div",{className:"col-md-8 my-3 mx-auto",children:b.dataList&&b.dataList.length>0?b.dataList.map((function(e,t){return Object(v.jsx)(pe,{post:e,setPosts:m},"post".concat(e.id))})):-1===b.currentPageNo&&Object(v.jsx)(v.Fragment,{children:"loading"})})]})})),xe=r(527),ge=r(529),ye=r(522),ve=r(264),we=n.a.memo((function(e){var t=e.setAddPostButtonClicked,r=Object(a.useContext)(Ee),n=(r.isCurrentUserUpdated,r.setIsCurrentUserUpdated,k.a.load("current_user"));return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(xe.a,{style:{position:"sticky"},bg:"light",fixed:"top",expand:"lg",children:[Object(v.jsx)(xe.a.Brand,{href:"/",children:"Citizen Sane"}),Object(v.jsx)(xe.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsx)(xe.a.Collapse,{id:"basic-navbar-nav",children:Object(v.jsxs)(ge.a,{className:"ml-auto",children:[Object(v.jsxs)(x.a,{className:"my-auto",inline:!0,children:[Object(v.jsx)(je.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),Object(v.jsx)(y.a,{variant:"light",children:"Search"})]}),Object(v.jsx)("div",{children:Object(v.jsx)(y.a,{variant:"light",onClick:function(e){t(!0)},children:"Add a post"})}),Object(v.jsxs)(ye.a,{variant:"light",className:"my-auto mr-4",menuAlign:"right",title:n.profileName,children:[Object(v.jsxs)(ve.a.Item,{href:"/profile/".concat(n.id),children:[Object(v.jsx)("div",{children:n.name}),Object(v.jsx)("div",{children:Object(v.jsx)("small",{children:"View your profile information"})})]}),Object(v.jsx)(ve.a.Divider,{}),Object(v.jsx)(ve.a.Item,{href:"#",children:"Give feedback"}),Object(v.jsx)(ve.a.Item,{href:"#",onClick:function(e){return k.a.remove("jwt",{path:"/"}),k.a.remove("current_user",{path:"/"}),void setTimeout((function(){return f.push("/login")}),800)},children:"Logout"})]})]})})]})})})),Se=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),r=t[0],n=t[1];return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(d.c,{history:f,children:[Object(v.jsx)(we,{setAddPostButtonClicked:n}),Object(v.jsxs)(d.d,{children:[Object(v.jsx)(d.b,{exact:!0,path:"/profile/:id",component:L}),Object(v.jsx)(d.b,{exact:!0,path:"/error",component:D}),Object(v.jsx)(d.b,{exact:!0,path:"/",render:function(){return Object(v.jsx)(fe,{setAddPostButtonClicked:n,addPostButtonClicked:r})}})]})]})})};function ke(){return!!(new N.a).get("current_user")}var Ee=n.a.createContext();var Ce=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),r={isCurrentUserUpdated:t[0],setIsCurrentUserUpdated:t[1]};return Object(v.jsx)("div",{children:Object(v.jsx)(d.c,{history:f,children:Object(v.jsxs)(d.d,{children:[Object(v.jsx)(d.b,{exact:!0,path:"/login",render:function(){return ke()?Object(v.jsx)(d.a,{to:{pathname:"/",state:{showAlert:!0,alertMessage:"You are logged in"}}}):Object(v.jsx)(C,{})}}),Object(v.jsx)(d.b,{exact:!0,path:"/register",render:function(){return ke()?Object(v.jsx)(d.a,{to:{pathname:"/",state:{showAlert:!0,alertMessage:"You are logged in"}}}):Object(v.jsx)(w,{})}}),Object(v.jsx)(d.b,{exact:!0,path:"*",render:function(){return ke()?Object(v.jsx)(Ee.Provider,{value:r,children:Object(v.jsx)(Se,{})}):Object(v.jsx)(d.a,{to:{pathname:"/login"}})}})]})})})},Ne=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,532)).then((function(t){var r=t.getCLS,a=t.getFID,n=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),a(e),n(e),c(e),s(e)}))};r(514);s.a.render(Object(v.jsxs)(n.a.StrictMode,{children:[Object(v.jsx)(Ce,{}),","]}),document.getElementById("root")),Ne()}},[[515,1,2]]]);
//# sourceMappingURL=main.41c42450.chunk.js.map